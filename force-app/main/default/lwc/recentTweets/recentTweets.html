<template>
    <lightning-card title="Recent Tweets">
        <template if:true={isCheckingAuthorization}>
            <div class="slds-p-vertical_medium slds-text-align_center slds-m-around_large">
                <div style="position:relative">
                    <div class="slds-spinner_container">
                        <div role="status" class="slds-spinner slds-spinner_medium slds-spinner_brand">
                            <span class="slds-assistive-text">Loading...</span>
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </div>
                <p class="slds-p-top_medium slds-m-top_medium">{statusMessage}</p>
            </div>
        </template>
        <template if:true={isUserAuthorized}>
            <template if:true={tweets.length}>
                <template for:each={tweets} for:item="tweet">
                    <div key={tweet.Tweet_ID__c} class="tweet slds-box slds-p-around_medium slds-m-around_medium">
                        <div class="tweet-header slds-grid slds-grid_align-spread">
                            <div class="tweet-date slds-text-color_weak">{tweet.formattedDate}</div>
                            <div class="tweet-actions">
                                <button class="text-button" data-id={tweet.Tweet_ID__c} onclick={handleDelete}>Delete</button>
                            </div>
                        </div>
                        <p>{tweet.Tweet_Text__c}</p>
                    </div>
                </template>
                <div class="pagination slds-grid slds-grid_align-spread">
                    <lightning-button 
                        label="Previous" 
                        onclick={handlePrevious} 
                        disabled={disablePrevious}
                        variant="neutral"
                        class="slds-button_outline-brand slds-p-horizontal_medium"
                    ></lightning-button>
                    <lightning-button 
                        label="Next" 
                        onclick={handleNext} 
                        disabled={disableNext}
                        variant="neutral"
                        class="slds-button_outline-brand slds-p-horizontal_medium"
                    ></lightning-button>
                </div>
            </template>

            <template if:true={isTweetsLoaded}>
                <template if:false={tweets.length}>
                    <div class="slds-text-align_center">
                        <img src={emptyImage} alt="No tweets found" class="empty-image"/>
                        <p>No tweets found</p>
                    </div>
                </template>
            </template>

        </template>
        <template if:false={isUserAuthorized}>
            <div class="slds-text-align_center slds-p-vertical_medium">
                <template if:false={isCheckingAuthorization}>
                    <div class="slds-text-align_center">
                        <img src={noAccessImage} alt="User is not authorized" class="no-access-image"/>
                    </div>
                    <p class="slds-p-vertical_medium">{statusMessage}</p>
                    <lightning-button label="Twitter log in" onclick={handleTwitterAuth}></lightning-button>
                </template>
            </div>
        </template>
    </lightning-card>
</template>